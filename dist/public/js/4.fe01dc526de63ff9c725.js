webpackJsonp([4],{281:function(t,e,n){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(71),i=s(o),a=n(1),r=s(a),l=n(86),c=s(l),u=n(20);e.default={data:function(){return{topic:{tab:"share",title:"",content:"",city:"Vancouver"},err:"",status:"ready",files:[],point:{},uploading:!1,percent:0,mobile:window.innerWidth<=992}},mounted:function(){window.addEventListener("resize",function(t){this.mobile=window.innerWidth<=992})},computed:(0,i.default)({},(0,u.mapGetters)({userInfo:"getUserInfo"})),methods:{add:function(){this.mobile?(this.$refs.file.click(),this.$refs.file.click()):this.$refs.file.click()},submit:function(){if(0===this.files.length)return void console.warn("no file!");var t=new FormData;this.files.forEach(function(e){t.append(e.name,e.file)})},finished:function(){this.files=[],this.status="ready"},remove:function(t){this.files.splice(t,1)},fileChanged:function(){for(var t=this.$refs.file.files,e=0;e<t.length;e++)if(!this.isContain(t[e])){var n={name:t[e].name,size:t[e].size,file:t[e]};this.html5Reader(t[e],n),this.files.push(n)}this.$refs.file.value=""},html5Reader:function(t,e){var n=this,s=new FileReader;s.onload=function(t){n.$set(e,"src",t.target.result)},s.readAsDataURL(t)},isContain:function(t){return this.files.forEach(function(e){if(e.name===t.name&&e.size===t.size)return!0}),!1},uploadProgress:function(t){var e=this;if(t.lengthComputable){var n=Math.round(100*t.loaded/t.total);e.percent=n/100}else console.warn("upload progress unable to compute")},addTopic:function(){var t=this,e=[];this.files.forEach(function(t){e.push(t.src)}),console.log(this.userInfo);var n=r.default.trim(this.topic.title),s=r.default.trim(this.topic.content);if(!n||n.length<10)return this.err="title",!1;if(!s)return this.err="content",!1;var o=(0,i.default)({},this.topic,{content:this.topic.content,imgs:e,accesstoken:this.userInfo.token});r.default.ajax({type:"POST",url:"/api/topics",data:o,dataType:"json",success:function(e){e&&t.$router.push({name:"list"})},error:function(e){var n=JSON.parse(e.responseText);return t.$alert(n.error_msg),!1}})}},components:{nvHead:c.default}}},289:function(t,e){},301:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nv-head",{attrs:{"page-type":"主题","show-menu":!1,"fix-head":!0}}),t._v(" "),n("div",{staticClass:"add-container"},[n("div",{staticClass:"line"},[t._v("选择分类：\n            "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.topic.tab,expression:"topic.tab"}],staticClass:"add-tab",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.topic,"tab",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"share"}},[t._v("分享")]),t._v(" "),n("option",{attrs:{value:"ask"}},[t._v("问答")]),t._v(" "),n("option",{attrs:{value:"job"}},[t._v("招聘")])]),t._v(" "),n("a",{staticClass:"add-btn",on:{click:t.addTopic}},[t._v("发布")])]),t._v(" "),n("div",{staticClass:"line"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.topic.title,expression:"topic.title"}],staticClass:"add-title",class:{err:"title"==t.err},attrs:{type:"text",placeholder:"标题，字数10字以上","max-length":"100"},domProps:{value:t.topic.title},on:{input:function(e){e.target.composing||t.$set(t.topic,"title",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"line"},[t._v("选择城市：\n            "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.topic.city,expression:"topic.city"}],staticClass:"add-tab",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.topic,"city",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"Vancouver"}},[t._v("温哥华")]),t._v(" "),n("option",{attrs:{value:"Richmond"}},[t._v("列治文")]),t._v(" "),n("option",{attrs:{value:"Burnaby"}},[t._v("本拿比")])])]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.topic.content,expression:"topic.content"}],staticClass:"add-content",class:{err:"content"==t.err},attrs:{rows:"10",placeholder:"回复支持Markdown语法,请注意标记代码"},domProps:{value:t.topic.content},on:{input:function(e){e.target.composing||t.$set(t.topic,"content",e.target.value)}}}),t._v(" "),n("div",{staticClass:"vue-uploader"},[n("div",{staticClass:"file-list"},[t._l(t.files,function(e,s){return n("section",{staticClass:"file-item draggable-item"},[n("img",{attrs:{src:e.src,alt:"",ondragstart:"return false;"}}),t._v(" "),n("p",{staticClass:"file-name"},[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"file-remove",on:{click:function(e){t.remove(s)}}},[t._v("+")])])}),t._v(" "),"ready"==t.status?n("section",{staticClass:"file-item"},[n("div",{staticClass:"add",on:{click:t.add}},[n("span",[t._v("+")])])]):t._e()],2),t._v(" "),n("input",{ref:"file",attrs:{type:"file",accept:"image/*",multiple:"multiple"},on:{change:t.fileChanged}})])])],1)},staticRenderFns:[]}},33:function(t,e,n){n(289);var s=n(66)(n(281),n(301),null,null);t.exports=s.exports},66:function(t,e){t.exports=function(t,e,n,s){var o,i=t=t||{},a=typeof t.default;"object"!==a&&"function"!==a||(o=t,i=t.default);var r="function"==typeof i?i.options:i;if(e&&(r.render=e.render,r.staticRenderFns=e.staticRenderFns),n&&(r._scopeId=n),s){var l=Object.create(r.computed||null);Object.keys(s).forEach(function(t){var e=s[t];l[t]=function(){return e}}),r.computed=l}return{esModule:o,exports:i,options:r}}},71:function(t,e,n){"use strict";e.__esModule=!0;var s=n(76),o=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t}},73:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),o=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default={replace:!0,props:{pageType:String,fixHead:Boolean,messageCount:Number,scrollTop:0,needAdd:{type:Boolean,default:!0}},data:function(){return{nickname:"",profileimgurl:"",show:!1}},methods:{openMenu:function(){(0,o.default)("body").css("overflow","hidden"),this.show=!this.show},showMenus:function(){this.show=!this.show,(0,o.default)("body").css("overflow","auto")}},components:{nvMenu:n(87)}}},74:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={replace:!0,props:["showMenu","pageType","nickName","profileUrl"],components:{userInfo:n(88)},methods:{logout:function(){window.window.sessionStorage.clear(),this.$store.dispatch("setUserInfo",null),this.$router.push("login")}}}},75:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(71),o=function(t){return t&&t.__esModule?t:{default:t}}(s),i=n(20);e.default={replace:!0,computed:(0,o.default)({},(0,i.mapGetters)({userInfo:"getUserInfo"})),methods:{goEnter:function(){this.$router.push({name:"login",query:{redirect:encodeURIComponent(this.$route.path)}})},goUser:function(){this.$router.push({name:"user",params:{loginname:this.userInfo.loginname}})}}}},76:function(t,e,n){t.exports={default:n(77),__esModule:!0}},77:function(t,e,n){n(81),t.exports=n(3).Object.assign},78:function(t,e,n){"use strict";var s=n(23),o=n(79),i=n(80),a=n(24),r=n(22),l=Object.assign;t.exports=!l||n(4)(function(){var t={},e={},n=Symbol(),s="abcdefghijklmnopqrst";return t[n]=7,s.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=s})?function(t,e){for(var n=a(t),l=arguments.length,c=1,u=o.f,f=i.f;l>c;)for(var d,p=r(arguments[c++]),v=u?s(p).concat(u(p)):s(p),m=v.length,h=0;m>h;)f.call(p,d=v[h++])&&(n[d]=p[d]);return n}:l},79:function(t,e){e.f=Object.getOwnPropertySymbols},80:function(t,e){e.f={}.propertyIsEnumerable},81:function(t,e,n){var s=n(21);s(s.S+s.F,"Object",{assign:n(78)})},82:function(t,e){},83:function(t,e){},86:function(t,e,n){var s=n(66)(n(73),n(90),null,null);t.exports=s.exports},87:function(t,e,n){n(82);var s=n(66)(n(74),n(89),null,null);t.exports=s.exports},88:function(t,e,n){n(83);var s=n(66)(n(75),n(91),null,null);t.exports=s.exports},89:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"nav-list",class:{show:t.showMenu},attrs:{id:"sideBar"}},[n("user-info"),t._v(" "),n("section",{staticClass:"list-ul"},[n("router-link",{staticClass:"icon-quanbu iconfont item",attrs:{to:{name:"list",query:{tab:"all"}}}},[t._v("全部")]),t._v(" "),n("router-link",{staticClass:"icon-hao iconfont item",attrs:{to:{name:"list",query:{tab:"good"}}}},[t._v("认证")]),t._v(" "),n("router-link",{staticClass:"icon-fenxiang iconfont item",attrs:{to:{name:"list",query:{tab:"share"}}}},[t._v("分享")]),t._v(" "),n("router-link",{staticClass:"icon-wenda iconfont item",attrs:{to:{name:"list",query:{tab:"ask"}}}},[t._v("问答")]),t._v(" "),n("router-link",{staticClass:"icon-zhaopin iconfont item",attrs:{to:{name:"list",query:{tab:"job"}}}},[t._v("招聘")]),t._v(" "),n("router-link",{staticClass:"icon-xiaoxi iconfont item line",attrs:{to:{name:"message"}}},[t._v("消息")]),t._v(" "),n("router-link",{staticClass:"icon-about iconfont item",attrs:{to:{name:"about"}}},[t._v("关于")]),t._v(" "),n("a",{staticClass:"icon-about iconfont item",on:{click:t.logout}},[t._v("登出")])],1)],1)},staticRenderFns:[]}},90:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.show&&t.fixHead?n("div",{staticClass:"page-cover",on:{click:t.showMenus}}):t._e(),t._v(" "),n("header",{class:{show:t.show&&t.fixHead,"fix-header":t.fixHead,"no-fix":!t.fixHead},attrs:{id:"hd"}},[n("div",{staticClass:"nv-toolbar"},[t.fixHead?n("div",{staticClass:"toolbar-nav",on:{click:t.openMenu}}):t._e(),t._v(" "),n("span",{domProps:{textContent:t._s(t.pageType)}}),t._v(" "),t.messageCount>0?n("i",{staticClass:"num"},[t._v(" "+t._s(t.messageCount))]):t._e(),t._v(" "),n("router-link",{attrs:{to:"/add"}},[t.needAdd?n("i",{directives:[{name:"show",rawName:"v-show",value:!t.messageCount||t.messageCount<=0,expression:"!messageCount || messageCount <= 0"}],staticClass:"iconfont add-icon"},[t._v("")]):t._e()])],1)]),t._v(" "),t.fixHead?n("nv-menu",{attrs:{"show-menu":t.show,"page-type":t.pageType,"nick-name":t.nickname,"profile-url":t.profileimgurl}}):t._e()],1)},staticRenderFns:[]}},91:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-info"},[t.userInfo.loginname?t._e():n("ul",{staticClass:"login-no"},[n("li",{staticClass:"login",on:{click:t.goEnter}},[n("a",[t._v("登录")])])]),t._v(" "),t.userInfo.loginname?n("div",{staticClass:"login-yes",on:{click:t.goUser}},[n("div",{staticClass:"avertar"},[t.userInfo.avatar_url?n("img",{attrs:{src:t.userInfo.avatar_url}}):t._e()]),t._v(" "),n("div",{staticClass:"info"},[t.userInfo.loginname?n("p",{domProps:{textContent:t._s(t.userInfo.loginname)}}):t._e()])]):t._e()])},staticRenderFns:[]}}});